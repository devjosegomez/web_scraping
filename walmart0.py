import requests
import json
import csv
import sys
import multiprocessing
import numpy

#File
FileCSV = "walmart.csv"
print FileCSV

#Categories
categories = ("l-lp-destacados-computadoras", "f-destacados-computadoras", "l-laps-laptops", "l-laps-chro", "l-laps-2-en-1-touchscreen", "l-laps-notebooks", "l-laps-ultrabooks", "l-laps-macbooks", "f-computo-laptops", "l-computo-pc", "l-computo-tabletas-graficas", "l-computo-all-in-one", "l-computo-monitores", "l-computo-cpu", "f-computo-de-escritorio", "l-tablets-todas", "l-tablets-accesorios", "l-accesorios-tabletas-graficas", "f-computo-tablets", "l-pc-gaming-juegos", "l-pc-gaming-accesorios", "l-pc-gaming-equipos", "f-videojuegos-pc-gaming", "l-scanner-impresion-cartuchos", "l-impresoras", "l-multifuncionales", "l-scanner", "f-computo-scanner-e-impresion", "l-perifericos-proyectores", "f-computo-perifericos", "l-apple-accesorios", "l-accesorio-reguladores", "l-accesorios-bocinas-audifonos", "l-accesorios-discos-duros", "l-accesorio-usb-sd", "l-accesorio-mouse-teclados-webcams", "l-accesorio-fundas-maletines", "l-accesorio-cargadores-baterias", "l-accesorio-cables-adaptadores", "l-accesorios-mochilas-laptops", "l-accesorios-tabletas-graficas", "l-accesorios-para-pc", "f-computo-accesorios", "l-software-antivirus", "l-software-office", "f-computo-software", "d-computo", "lp-l-destacados-peliculas", "f-destacados-peliculas", "l-dvd-accion", "l-dvd-anime", "l-dvd-aventura", "l-dvd-comedia", "l-dvd-crimen", "l-dvd-documental", "l-dvd-drama", "l-dvd-familiar", "l-dvd-infantil", "l-dvd-musical", "l-dvd-romantica", "l-dvd-sci-fi", "l-dvd-suspenso", "l-dvd-terror", "f-peliculas-dvd", "l-blu-ray-3d-accion", "f-peliculas-blu-ray-3d", "l-blu-ray-accion", "l-blu-ray-anime", "l-blu-ray-aventura", "l-blu-ray-comedia", "l-blu-ray-documental", "l-blu-ray-drama", "l-blu-ray-familiar", "l-blu-ray-infantil", "l-blu-ray-musical", "l-blu-ray-romantica", "l-blu-ray-sci-fi", "l-blu-ray-suspenso", "l-blu-ray-terror", "f-peliculas-blu-ray", "l-series-dvd", "l-series-blu-ray", "f-peliculas-series", "l-coleccionistas-dvd", "l-coleccionistas-blu-ray", "l-coleccionistas-series", "f-peliculas-coleccionistas", "l-peliculas-4k", "f-peliculas-4k", "d-peliculas", "lp-l-destacados-bebes", "f-destacados-bebes", "l-carriolas-sistema-de-viaje", "l-carriolas-estandar", "l-carriolas-ligeras", "l-carriolas-dobles", "l-carriolas-accesorios", "f-bebes-carriolas", "l-autoasientos-convertibles", "l-autoasientos-infantiles", "l-autoasientos-booster", "l-carriolas-sistema-de-viaje", "f-bebes-autoasientos", "l-cuarto-del-bebe-cunas", "l-cuarto-del-bebe-mecedoras", "l-cuarto-del-bebe-muebles", "l-cuarto-del-bebe-cuna-de-viaje", "l-cuarto-del-bebe-moises", "l-cuarto-del-bebe-ropa-de-cama", "l-monitores-monitores", "l-cuarto-del-bebe-colchones", "l-cuarto-del-bebe-decoracion", "l-cuarto-del-bebe-organizacion", "l-cuarto-del-bebe-cobijas", "f-bebes-cuarto-del-bebe", "l-panales-panales", "l-panales-toallitas", "l-panales-panales-de-tela", "l-panales-calzones-entrenadores", "l-panales-botes-y-accesorios", "l-panales-cambiadores", "l-panales-panaleras", "l-panales-promociones-del-mes", "f-bebes-panales", "l-juguetes-gimnasios-y-tapetes", "l-juguetes-andaderas", "l-juguetes-columpios", "l-juguetes-moviles", "l-juguetes-de-bebe", "l-cuidado-accesorios", "l-alimentacion-mordederas", "f-bebes-juguetes-y-estimulacion", "l-alimentacion-biberones", "l-alimentacion-sillas-y-boosters", "l-alimentacion-esterilizadores", "l-alimentacion-vasos-entrenadores", "l-alimentacion-platos-y-cubiertos", "l-alimentacion-baberos", "l-alimentacion-mordederas", "l-alimentacion-accesorios", "l-alimentacion-lactancia", "l-mama-almohadas-de-maternidad", "f-bebes-alimentacion", "l-monitores-monitores", "l-monitores-puertas-de-seguridad", "l-monitores-seguridad-del-bebe", "f-bebes-monitores-y-seguridad", "l-cuidado-baneras", "l-cuidado-accesorios", "l-cuidado-batas-y-toallas", "l-cuidado-aseo-del-bebe", "l-cuidado-banos-entrenadores", "l-panales-toallitas", "l-cuidado-salud-del-bebe", "f-bebes-cuidado-e-higiene", "l-alimentacion-lactancia", "l-panales-panaleras", "l-mama-almohadas-de-maternidad", "l-mama-cangurera", "f-bebes-mama", "l-cuarto-de-ninos-mesitas", "l-cuarto-de-ninos-accesorios", "f-bebes-cuarto-ninos", "l-ropa-bebes-panaleros", "f-ropa-bebes-ropa", "d-bebes", "lp-l-destacados-papeleria", "f-destacados-papeleria", "l-papeleria-mochilas", "l-papeleria-calculadoras", "l-papeleria-papel", "l-papeleria-libretas", "l-papeleria-basica", "l-papeleria-escritura", "l-papeleria-pizarrones", "f-oficina-papeleria-papeleria", "l-papeleria-enmicadoras", "l-papeleria-plumas", "l-papeleria-organizacion", "l-papeleria-maletines", "l-papeleria-seguridad", "l-papeleria-negocio", "l-papeleria-basica", "l-papeleria-archiveros", "l-papeleria-mantenimiento", "l-oficina-escritorios", "l-oficina-sillas", "l-laps-laptops", "l-multifuncionales", "l-impresoras", "f-oficina-papeleria-negocio", "l-papeleria-estuches-arte", "l-papeleria-pinturas-pinceles", "l-papeleria-lapices", "l-papeleria-colores-plumines", "l-papeleria-carbones", "l-papeleria-blocks", "l-papeleria-caballetes", "l-papeleria-estilografos", "l-papeleria-corte", "l-papeleria-manualidades", "f-oficina-papeleria-arte", "l-papeleria-disfraz-adulto", "l-papeleria-disfraz-nino", "l-papeleria-mascaras", "l-papeleria-accesorios", "l-papeleria-fiesta", "f-oficina-papeleria-fiesta", "d-papeleria", "lp-l-destacados-salud", "f-destacados-salud-y-belleza", "l-perfumes-lociones-hombre", "l-perfumes-lociones-mujer", "l-perfumes-lociones-ninos", "l-perfumes-lociones-sets-mujer", "l-perfumes-lociones-sets-hombre", "f-belleza-perfumes-lociones", "l-cabello-planchas", "l-cabello-secadoras", "l-cabello-rizadoras", "l-cabello-shampoo", "l-cabello-gel", "l-cabello-ceras-cremas", "l-cabello-cepillos-accesorios", "f-belleza-cuidado-cabello", "l-maquillaje-rostro", "l-maquillaje-ojos", "l-maquillaje-labios", "l-maquillaje-unas", "l-maquillaje-brochas-accesorios", "l-maquillaje-dermatologico", "f-belleza-maquillaje", "l-afeitado-rasuradoras-electricas", "l-afeitado-recortadoras", "l-afeitado-barba", "l-afeitado-depiladoras", "f-belleza-afeitado", "l-cuidado-corporal-exfoliantes-cremas", "l-cuidado-corporal-jabones-limpieza", "l-cuidado-corporal-dermatologicos", "f-belleza-cuidado-corporal", "l-cuidado-facial-cremas", "l-cuidado-facial-tratamientos", "l-cuidado-facial-exfoliantes-mascarillas", "l-cuidado-facial-desmaquillantes", "l-cuidado-facial-dermatologicos", "l-cuidado-facial-tonicos", "f-belleza-cuidado-facial", "l-higiene-personal-bloqueadores-bronceadores", "f-belleza-higiene-personal", "l-spa-masaje", "l-spa-masaje-camas-sillas", "l-spa-masaje-productos", "l-spa-masaje-aromaterapia", "f-salud-spa-masaje", "d-salud-belleza", "lp-l-destacados-accesorios", "f-destacados-accesorios", "l-relojes-hombres", "l-relojes-mujer", "l-relojes-ninos", "f-accesorios-moda-relojes", "l-lentes-sol-hombre", "l-lentes-sol-mujer", "l-lentes-oftalmicos-hombre", "l-lentes-oftalmicos-mujer", "f-accesorios-moda-lentes-sol", "l-joyeria-aretes", "l-joyeria-collares", "l-joyeria-juegos-joyas", "l-joyeria-pulseras", "l-joyeria-anillos", "l-joyeria-argollas-arras-anillos-compromiso", "l-joyeria-joyeros", "l-joyeria-religiosa", "f-moda-accesorios-joyeria", "l-maletas-viaje", "l-maletas-sets", "l-maletas-ninos", "l-maletas-accesorios", "f-moda-accesorios-maletas", "l-bolsas-y-carteras-carteras-hombre", "l-accesorios-hombre-gorras-gorros", "l-accesorios-hombre-cinturones", "l-accesorios-hombre-corbatas-monos", "l-bolsas-y-carteras-mariconeras-bolsas-hombre", "l-accesorios-hombre-mancuernillas", "l-accesorios-hombre-otros-accesorios", "f-moda-accesorios-hombre", "l-bolsas-mujer", "l-carteras-mujer", "l-bolsas-y-carteras-mochilas-moda", "l-accesorios-ninos-bebes-accesorios-cabello", "l-accesorios-mujer-otros-accesorios-moda", "f-moda-accesorios-mujer", "l-lenceria-pijamas-brasieres", "l-lenceria-pijamas-calzones", "f-ropa-zapatos-mujer-lenceria-pijamas", "d-accesorios-moda", "l-lp-destacados-linea-blanca", "f-destacados-linea-blanca", "l-refrigeradores", "l-congeladores", "l-frigobares", "l-cavas", "f-linea-blanca-refrigeradores", "l-lavadoras-lavadoras", "l-lavadoras-secadoras", "l-lavasecadoras", "l-lavadoras-centros", "f-linea-blanca-lavadoras", "l-estufas-microondas", "l-estufas-estufas", "l-estufas-parrillas", "l-campanas", "l-estufas-hornos-empotrables", "l-estufas-lavavajillas", "f-linea-blanca-estufas", "l-aire-acondicionado", "l-aire-ventiladores", "l-aire-calefactores", "l-aire-calentadores", "f-linea-blanca-aire-acondicionado", "d-linea-blanca", "l-lp-destacados-instrumentos-musicales", "f-destacados-instrumentos", "l-instrumentos-guitarras-acusticas", "l-instrumentos-guitarras-electroacusticas", "l-instrumentos-guitarras-electricas", "l-instrumentos-bajos", "l-instrumentos-violines-ukuleles", "l-instrumentos-afinadores-cuerdas", "f-instrumentos-de-cuerdas", "l-instrumentos-teclados", "l-instrumentos-pianos", "l-instrumentos-bancos-fundas", "f-instrumentos-teclado", "l-instrumentos-baterias", "l-instrumentos-tambores-percusiones", "l-instrumentos-platillos-baquetas", "f-instrumentos-percusion", "l-instrumentos-saxofones-tompetas", "l-instrumento-boquillas-canas", "f-instrumentos-viento-arcordeones", "l-instrumentos-amplificadores", "l-instrumentos-microfono", "l-instrumentos-atriles", "f-instrumentos-amplificadores", "l-dj-controladores", "l-dj-audifonos", "l-dj-tornamesas", "l-dj-accesorios", "l-dj-bocinas-monitores", "f-audio-dj", "d-instrumentos-musicales", "l-lp-destacados-colchones", "f-destacados-colchones", "l-colchones-matrimoniales", "l-colchones-individuales", "l-colchones-queen-size", "l-colchones-king-size", "l-colchones-bases", "l-cuarto-del-bebe-colchones", "f-colchones", "l-blancos-colchas-edredones", "l-blancos-almohadas", "l-blancos-sabanas-frazadas", "l-blancos-cubre-colchon", "l-blancos-cobertores", "l-muebles-de-bano-toallas", "f-blancos", "d-colchones-blancos", "l-lp-destacados-salud-bienestar", "f-destacados-bienestar", "l-equipo-medico-camas", "l-equipo-medico-oxigenoterapia", "l-equipo-medico-baumanometros", "l-equipo-medico-termometros", "l-equipo-medico-humidificadores", "l-running-monitores-cardiacos-actividad", "l-equipo-medico-laboratorio", "l-equipo-medico-instrumental", "f-salud-equipo-medico", "l-equipo-ortopedico-rehabilitacion", "l-equipo-ortopedico-sillas", "l-equipo-ortopedico-movilidad", "l-equipo-ortopedico-cuidado-paciente", "f-salud-equipo-ortopedico", "l-lentes-oftalmicos-hombre", "l-lentes-oftalmicos-mujer", "l-lentes-oftalmicos-lentes-contacto", "f-salud-lentes-oftalmicos", "l-fajas-control-peso", "l-fajas-control-peso-basculas-medidores", "l-fajas-control-peso-productos-terapeuticos", "f-salud-fajas-control-peso", "l-higiene-bucal-dental-cepillos-electricos", "l-higiene-bucal-dental-higiene", "f-salud-higiene-bucal-dental", "l-spa-masaje", "l-spa-masaje-camas-sillas", "l-spa-masaje-productos", "l-spa-masaje-aromaterapia", "f-salud-spa-masaje", "l-medicina-nutricion-proteinas-suplementos", "l-medicina-nutricion-vitaminas", "f-salud-vitaminas-suplementos", "d-salud-bienestar", "l-lp-destacados-ferreteria", "f-destacados-ferreteria", "l-herramientas-electricas-taladros", "l-herramientas-electricas-rotomartillos", "l-herramientas-electricas-pulidoras", "l-herramientas-electricas-sierras", "l-herramientas-electricas-pistolas", "l-herramientas-electricas-compresores", "l-accesorios-herramientas-autos", "f-ferreteria-herramientas-electricas", "l-herramientas-manuales-juegos", "l-herramientas-manuales-seguetas", "l-herramientas-manuales-carretillas", "l-herramientas-manuales-matracas", "l-herramientas-manuales-llaves", "l-herramientas-manuales-cucharas", "l-herramientas-manuales-medicion", "l-organizacion-almacenaje-cajas", "l-maquinaria-y-equipo-remaches-sujetadores-y-mas", "f-ferreteria-herramientas-manuales", "l-seguridad-industrial-cascos", "l-seguridad-industrial-chalecos", "l-seguridad-industrial-lentes", "l-seguridad-industrial-senalizacion", "f-ferreteria-seguridad", "l-jardineria-herramientas", "l-hogar-timbres", "l-hogar-cerraduras", "l-hogar-cadenas", "l-hogar-pilas", "f-ferreteria-hogar", "l-electricidad-ventiladores", "l-electricidad-linternas", "l-electricidad-focos", "l-electricidad-lamparas", "l-electricidad-lamparas-pared", "l-electricidad-lamparas-vintage", "f-ferreteria-iluminacion", "l-casas-inteligentes-destacados", "l-casa-inteligente-iluminacion", "l-casa-inteligente-cerraduras", "l-casa-inteligente-seguridad", "l-casa-inteligente-automatizacion", "f-casa-inteligente", "l-organizacion-almacenaje-organizadores", "l-organizacion-almacenaje-cajas", "l-jardineria-cobertizos", "organizacion-closet", "f-ferreteria-organizacion", "l-electricidad-extensiones", "l-electricidad-accesorios", "l-electricidad-cables", "l-electricidad-matainsectos", "f-ferreteria-electricidad", "l-plomeria-grifos", "l-plomeria-bombas", "l-plomeria-mangueras", "l-plomeria-accesorios", "l-plomeria-rejillas", "f-ferreteria-plomeria", "l-lonas-lonas", "l-lonas-accesorios", "f-ferreteria-lonas", "l-maquinaria-y-equipo-maquinaria-para-construccion", "l-maquinaria-y-equipo-equipo-para-soldar", "f-ferreteria-maquinaria-y-equipo", "d-ferreteria", "l-lp-destacados-audio", "f-destacados-audio", "l-audio-casa-accesorios", "l-audio-casa-barras", "l-audio-casa-teatro", "l-audio-casa-receptores", "f-audio-casa", "l-dj-audifonos", "l-audifonos-in-ear-bluetooth", "l-audifonos-diadema-bluetooth", "l-audifonos-deportivos-bluetooth", "l-audifonos-in-ear", "l-audifonos-deportivos", "l-audifonos-diadema", "f-audio-audifonos", "l-audio-bocinas-exterior", "l-audio-bocinas-auto", "l-audio-bafles", "l-audio-bocinas", "l-audio-bocinas-casa", "f-audio-bocinas", "l-audio-casa-radiograbadora", "l-audio-casa-Karaoke", "l-audio-bafles", "l-audio-casa-grabadoras-voz", "l-audio-casa-microfonos", "l-audio-casa-micro-minis", "f-audio-minicomponentes-grabadoras", "l-car-audio-estereos", "l-car-audio-bocinas", "l-car-audio-amplificadores", "l-car-audio-gps", "l-accesorios-herramientas-gps-dispositivos-electronicos", "l-car-audio-subwoofers", "f-audio-car-audio", "l-audio-portatiles-reproductores", "l-audio-portatil-accesorios", "f-audio-portatil", "l-dj-controladores", "l-dj-audifonos", "l-dj-tornamesas", "l-dj-accesorios", "l-dj-bocinas-monitores", "f-audio-dj", "d-audio", "lp-l-destacados-autos", "f-destacados-autos", "l-llantas-rines-moto", "l-llantas-rines-tapones", "l-llantas-rines-13", "l-llantas-rines-14", "l-llantas-rines-15", "l-llantas-rines-16", "l-llantas-rines-17", "l-llantas-rines-18", "l-llantas-rines-19", "l-llantas-rines-20", "l-llantas-rines-21", "f-autos-motos-llantas-rines", "l-accesorios-herramientas-gps-dispositivos-electronicos", "l-accesorios-herramientas-tapetes-fundas-cubreasientos", "l-accesorios-herramientas-almacenamiento-tuning", "l-accesorios-herramientas-limpiaparabrisas", "l-accesorios-herramientas-portaequipaje-carga-racks", "l-accesorios-herramientas-alarmas-seguridad", "l-accesorios-herramientas-autos", "l-accesorios-herramientas-manuales", "l-accesorios-herramientas-dados-llaves", "f-autos-motos-accesorios-herramientas", "l-limpieza-estetica-automotriz-hidrolavadoras", "l-limpieza-estetica-automotriz-aspiradoras-auto", "l-limpieza-estetica-automotriz-pulido-cuidado", "l-limpieza-estetica-automotriz-accesorios", "f-autos-motos-limpieza-estetica-automotriz", "lp-l-motos-destacados", "l-motos-ciudad", "l-motos-deportivas", "l-motos-motonetas", "l-motos-cuatrimotos", "l-motos-chopper", "l-motos-doble-proposito", "l-motos-trabajo", "f-deportes-motos", "l-repuestos-iluminacion-automotriz-faros-focos", "l-ilumonacion-automotriz-faros", "f-autos-iluminacion-automotriz", "l-aceites-lubricantes-aditivos-motor", "l-aceites-lubricantes-aditivos-anticongelantes", "l-aceites-lubricantes-aditivos", "l-aceites-lubricantes-aditivos-filtros-accesorios", "f-autos-motos-aceites-lubricantes-aditivos", "l-car-audio-estereos", "l-car-audio-bocinas", "l-car-audio-amplificadores", "l-car-audio-gps", "l-accesorios-herramientas-gps-dispositivos-electronicos", "l-car-audio-subwoofers", "f-audio-car-audio", "l-repuestos-iluminacion-automotriz-refacciones-auto", "f-autos-motos-repuestos-iluminacion-automotriz", "l-accesorios-herramientas-accesorios-moto", "l-moto-cascos-guantes-ropa", "f-deportes-accesorios-moto", "d-autos", "l-lp-destacados-celulares", "f-destacados-celulares", "l-telefonos-smart-desbloqueados", "l-telefonos-smart-telcel", "l-telefonos-smart-iusacell", "l-telefonos-smart-unefon", "l-telefonos-smart-movistar", "l-telefonos-smart-virgin", "f-celulares-telefonos-smart", "l-telefonos-alambricos", "l-telefonos-inalambricos", "f-telefonos-fijos", "l-accesorios-weareables", "l-accesorios-smartwatch", "f-celulares-smartwatch-wearables", "l-accesorios-fundas", "l-accesorios-protectores-pantalla", "l-accesorios-protectores-soportes", "f-celulares-fudas-micas-bases", "l-accesorios-cables-cargadores", "l-accesorios-baterias-portatiles-baterias", "f-accesorios-cargadores-baterias", "d-celulares", "lp-l-destacados-deportes", "f-destacados-deportes", "l-fitness-caminadoras", "l-fitness-bicicletas-elipticas", "l-fitness-bicicletas-spinning", "l-fitness-gimnasios-aparatos-ejercicio", "l-fitness-aparatos-abdominales", "l-fitness-remadoras-otros", "l-running-monitores-cardiacos-actividad", "l-fitness-yoga-pilates", "l-fitness-pesas", "l-fitness-cantimploras-mochilas-hidratacion", "l-fitness-soporte-rehabilitacion", "f-deportes-fitness", "l-recreativos-trampolines", "l-recreativos-sala-juego", "f-deportes-recreativos", "l-camping-casas-campana", "l-camping-sleepings", "l-camping-colchones", "l-camping-muebles-campismo", "l-camping-hieleras", "l-camping-mochilas-cangureras", "l-fitness-cantimploras-mochilas-hidratacion", "l-camping-accesorios-acampar", "l-camping-estufas-asadores-utensilios", "l-camping-lamparas", "l-muebles-jardin-mesas-sillas-plegables", "f-deportes-camping", "l-ciclismo-bicicletas-urbanas", "l-ciclismo-montana", "l-ciclismo-bicicletas-electricas-plegables", "l-bicicletas-patinetas-balance", "l-bicicletas-bicicletas", "l-ciclismo-accesorios-bicicletas", "l-ciclismo-cascos-proteccion", "l-accesorios-herramientas-portaequipaje-carga-racks", "l-ciclismo-refacciones-herramientas", "l-ciclismo-gadgets-bicicletas", "f-deportes-ciclismo", "l-deportes-acuaticos-natacion", "l-deportes-acuaticos-albercas-spa", "l-deportes-acuaticos-inflables-juguetes-alberca", "l-deportes-acuaticos-botes-kayaks-surf", "l-deportes-acuaticos-snorkel-buceo", "f-deportes-acuaticos", "lp-l-motos-destacados", "l-motos-ciudad", "l-motos-deportivas", "l-motos-motonetas", "l-motos-cuatrimotos", "l-motos-chopper", "l-motos-doble-proposito", "l-motos-trabajo", "f-deportes-motos", "l-accesorios-herramientas-accesorios-moto", "l-moto-cascos-guantes-ropa", "f-deportes-accesorios-moto", "l-deportes-futbol", "l-deportes-futbol-americano", "l-deportes-basquetbol", "l-deportes-beisbol", "l-deportes-voleibol", "f-deportes-deportes", "l-deportes-tenis", "l-deportes-squash-badminton-padel", "l-individuales-golf", "l-individuales-box", "f-deportes-individuales-y-contacto", "l-running-accesorios-correr", "l-running-monitores-cardiacos-actividad", "l-zapatos-tenis-hombre", "f-deportes-running", "l-ropa-oficial-accesorios-deportivos-futbol", "l-ropa-oficial-accesorios-deportivos-futbol-americano", "l-ropa-oficial-accesorios-deportivos-lentes", "f-deportes-ropa-oficial-accesorios-deportivos", "l-deportiva-playeras-tops", "l-deportiva-pants-pantalones", "l-deportiva-licras-mallas", "l-deportiva-faldas-shorts", "l-deportiva-sudaderas-chamarras", "f-ropa-zapatos-mujer-deportiva", "l-deportiva-polos-playeras", "l-deportiva-pants", "l-deportiva-shorts", "l-deportiva-sudaderas", "f-ropa-zapatos-hombre-deportiva", "l-deportiva-ninos-playeras", "l-deportiva-ninos-pants", "f-ropa-deportiva-ninos", "l-zapatos-tenis-hombre", "f-deportes-calzado", "l-fitness-soporte-rehabilitacion", "l-medicina-nutricion-proteinas-suplementos", "l-medicina-nutricion-vitaminas", "l-medicina-nutricion-cinta-kinesiologicas", "f-deportes-medicina-nutricion", "d-deportes", "lp-l-destacados-electrodomesticos", "f-destacados-electrodomesticos", "l-licuadoras-licuadoras", "l-licuadoras-batidoras", "l-licuadoras-procesador", "f-electrodomesticos-licuadoras", "l-cafeteras-cafeteras", "l-cafeteras-extractores", "l-cafeteras-teteras", "f-electrodomesticos-cafeteras", "l-hornos-electricos", "l-hornos-tostadores", "l-hornos-sandwicheras", "f-electrodomesticos-hornos-sandwicheras", "l-vaporeras", "l-vaporeras-parrillas", "l-vaporeras-freidoras", "f-electrodomesticos-vaporeras", "l-planchas-maquinas", "l-planchas-vapor", "l-planchas-centrales", "f-electrodomesticos-planchas", "l-aspiradoras", "l-aspiradoras-limpiadores", "f-electrodomesticos-aspiradoras", "l-purificadores-dispensador", "l-purificador-agua", "f-electrodomesticos-purificadores", "l-especializados-postres", "l-especializados-utensilios", "f-electrodomesticos-especializados", "d-electrodomesticos", "l-lp-destacados-fotografia", "f-destacados-fotografia", "l-camaras-profesionales", "l-camaras-automaticas", "l-camaras-reflex", "l-camaras-acuaticas", "l-camaras-deportivas", "l-camaras-instantaneas", "f-fotografia-camaras", "l-videocamaras-profesionales", "l-videocamaras-deportivas", "l-videocamaras-digitales", "f-fotografia-videocamaras", "l-foto-accesorios-lentes", "l-foto-accesorios-microfono-para-camaras", "l-foto-accesorios-flash", "l-foto-accesorios-filtros", "l-foto-accesorios-tripies-estabilizadores", "l-foto-accesorios-estuches-maletines-limpieza", "l-foto-accesorios-camaras-deportivas", "f-accesorios-fotografia", "l-foto-accesorios-memorias-micro", "l-foto-accesorios-memorias-sd", "l-foto-accesorios-baterias-cargadores", "l-foto-accesorios-monitores-cables", "f-accesorios-almacenamiento-energia", "d-fotografia", "lp-l-destacados-hogar", "f-destacados-hogar", "l-articulos-cocina-baterias", "l-articulos-cocina-sartenes", "l-articulos-cocina-ollas-cacerolas", "l-linea-profesional", "l-utensilios-cocina", "l-hermeticos-refractarios", "l-utensilios-horneado", "l-parrilla-utensilios", "l-articulos-cafe-te", "l-termos-hidratacion", "f-hogar-articulos-cocina", "l-mesa-vajillas", "l-servicio-mesa", "l-mesa-vasos-copas", "l-mesa-cubiertos", "l-mesa-cuchillos", "l-mesa-manteles", "l-mesa-bar-cocteleria", "f-hogar-mesa", "l-organizadores-closet", "l-zapateras", "l-cajas-organizadoras", "l-organizadores-cocina", "l-limpieza-botes-basura", "l-organizacion-ganchos", "f-hogar-organizacion-hogar", "l-cestos-ropa", "l-accesorios-lavanderia", "l-estantes-gabinetes", "l-bancos-escaleras", "f-hogar-cuarto-lavado", "l-casas-inteligentes-destacados", "l-casa-inteligente-iluminacion", "l-casa-inteligente-cerraduras", "l-casa-inteligente-seguridad", "l-casa-inteligente-automatizacion", "f-casa-inteligente", "l-electricidad-ventiladores", "l-electricidad-linternas", "l-electricidad-focos", "l-electricidad-lamparas", "l-electricidad-lamparas-pared", "l-electricidad-lamparas-vintage", "f-ferreteria-iluminacion", "l-decoracion-tapetes", "l-decoracion-cojines-decorativos", "l-decoracion", "l-decoracion-portarretratos", "l-decoracion-cuadros", "l-decoracion-floreros", "l-decoracion-relojes", "f-muebles-decoracion", "l-persianas", "l-cortinas", "f-hogar-persianas-cortinas", "d-hogar", "lp-l-destacados-juguetes", "f-destacados-juguetes", "l-montables-electricos", "l-montables-correpasillos", "f-juguetes-montable", "l-munecas-moda", "l-munecas-bebe", "l-munecas-accesorios", "l-munecas-animalitos", "l-munecas-peluches", "l-munecas-porcelana", "f-juguetes-munecas-moda", "l-exterior-casitas", "l-exterior-juegos", "l-exterior-albercas", "f-juguetes-juegos-exterior", "l-figuras-accion", "l-figuras-coleccion", "l-figuras-geek", "f-juguetes-figuras-accion", "l-bicicletas-bicicletas", "l-bicicletas-patinetas-balance", "l-bicicletas-patines", "l-bicicletas-scooters", "l-bicicletas-cascos", "l-ciclismo-montana", "l-ciclismo-bicicletas-urbanas", "l-ciclismo-bicicletas-electricas-plegables", "f-juguetes-bicicletas-patines-scooters", "l-juguetes-de-bebe", "l-preescolar-juguetes", "f-juguetes-preescolar", "l-construccion-lego", "l-construccion-megablocks", "l-construccion-playmobil", "l-construccion-bloques", "f-juguetes-construccion", "l-dibujo-manualidades-modelado", "l-dibujo-manualidades-pizarrones", "l-dibujo-manualidades-juegos", "f-juguetes-arte-dibujo-manualidades", "l-juegos-mesa", "l-juegos-rompecabezas", "f-juguetes-juegos-mesa-rompecabezas", "l-lanzadores-lanzadores", "l-lanzadores-agua", "f-juguetes-lanzadores", "l-juguetes-autos-coleccion", "l-juguetes-autos-carritos", "l-juguetes-autos-pistas", "l-juguetes-autos-control", "l-juguetes-autos-aviones-control", "l-juguetes-autos-barcos-control", "f-juguetes-autos", "l-papeleria-disfraz-nino", "l-papeleria-accesorios", "f-juguetes-disfraces", "l-electronico-mascotas", "l-electronico-juguetes", "f-juguetes-electronico", "l-juguetes-drones-drones-control-remoto", "l-juguetes-drones-accesorios", "f-juguetes-drones", "l-modelismo-automodelismo", "l-modelismo-modelismo-naval", "f-juguetes-modelismo", "l-paquetes-especiales-juguetes", "f-juguetes-paquetes", "d-juguetes", "lp-l-destacados-libros", "f-destacados-libros", "l-arte-mexicano", "l-arte-fotografia", "l-arte-cine", "l-arte-decoracion", "l-arte-dibujo", "l-arte-escultura", "l-arte-historia-teoria-critica-arte", "l-arte-museografia", "l-arte-musica-danza", "l-arte-novela-grafica", "l-arte-obra", "l-arte-arquitectura-urbanismo", "f-libros-arte", "l-historia-antropologia-arqueologia-sociologia", "l-historia-mexico-politica", "f-libros-historia", "l-lenguaje-referencia-cursos-autoaprendizaje", "l-lenguaje-referencia-enciclopedias", "l-lenguaje-referencia-lenguaje", "l-lenguaje-referencia-metodologia-bibliotecologia", "f-libros-lenguaje-referencia", "l-texto-recursos-padres-profesores", "f-libros-texto", "l-adolecentes-literatura", "l-literatura-ciencia-ficcion", "l-literatura-ensayo-literario", "l-literatura-iberoamericana", "l-ninos-mitos-leyendas", "l-novelas-erotica", "l-novelas-fantasia-ciencia-ficcion", "l-novelas-historica", "l-novelas-mexicana", "l-novelas-policiaca", "l-novelas-terror-suspenso", "l-poesia-poesia", "l-libros-otros-idiomas", "l-ninos-fabulas", "f-libros-literatura", "l-adolecentes-comics-historietas", "l-adolecentes-literatura", "l-ninos-mitos-leyendas", "l-ninos-pasatiempos-cuadernos-ejercicio", "l-ninos-cuadernos-ejercicios", "l-ninos-fabulas", "f-libros-ninos", "l-arte-jardineria", "l-arte-manualidades", "l-cuerpo-alma-espiritu-familia-superacion-personal", "l-ocio-deporte-recreacion", "l-ocio-gatronomia", "l-ocio-viajes", "f-libros-ocio", "l-adolecentes-padres-hijos", "l-cuerpo-alma-espiritu-religion-espiritualidad", "l-ninos-animales", "l-libros-biografias-memoria", "l-libros-con-iva", "l-libros-accesorios", "f-libros-otros", "l-licenciaturas-profesionistas-contaduria-administracion", "l-licenciaturas-profesionistas-biologia-zoo-eco", "l-licenciaturas-profesionistas-derecho", "l-licenciaturas-profesionistas-economia", "l-licenciaturas-profesionistas-filosofia", "l-licenciaturas-profesionistas-finanzas", "l-licenciaturas-profesionistas-fisica", "l-licenciaturas-profesionistas-ingenieria-tecnologia", "l-licenciaturas-profesionistas-matematicas", "l-licenciaturas-profesionistas-mercadotecnia", "l-licenciaturas-profesionistas-pedagogia", "l-licenciaturas-profesionistas-quimica", "l-licenciaturas-profesionistas-computacion", "l-licenciaturas-profesionistas-turismo-hoteleria", "l-licenciaturas-profesionistas-sexualidad-ciencias-salud", "l-licenciaturas-profesionistas-comunicacion", "l-psicologia-psicoanalisis-psiquiatria", "f-libros-licenciaturas-profesionistas", "l-libros-lectores", "f-libros-lectores", "libros-walmart", "lp-l-destacados-mascotas", "f-destacados-mascotas", "l-perros-alimento-premium", "l-perros-alimento", "l-perros-premios-carnazas", "l-perros-muebles", "l-perros-camas", "l-perros-casas-transportadoras-perreras", "l-perros-platos-bebederos", "l-perros-juguetes", "l-perros-ropa", "l-perros-correas-collares-arneses", "l-perros-seguridad", "l-perros-salud", "l-perros-limpieza", "f-mascotas-perros", "l-gatos-alimento-premium", "l-gatos-alimento", "l-gatos-arena-areneros", "l-gatos-muebles", "l-gatos-platos-bebederos", "l-gatos-casas", "l-gatos-ropa", "l-gatos-juguetes", "l-gatos-limpieza-higiene", "l-gatos-salud", "f-mascotas-gatos", "l-peces-alimento", "l-peces-acuarios-peceras", "l-peces-decoracion", "l-peces-iluminacion-acuarios", "l-peces-salud", "f-mascotas-peces", "l-aves-alimento", "l-aves-nidos-jaulas", "l-aves-comederos", "l-aves-juguetes", "f-mascotas-aves", "l-pequenas-mascotas-alimento", "l-pequenas-mascotas-habitats", "l-pequenas-mascotas-juguetes", "l-pequenas-mascotas-accesorios", "l-pequenas-mascotas-limpieza-higiene", "f-mascotas-pequenas-mascotas", "l-reptiles-alimento", "l-reptiles-terrarios", "l-reptiles-iluminacion", "l-reptiles-salud", "f-mascotas-reptiles", "d-mascotas", "l-lp-destacados-muebles", "f-destacados-muebles", "l-salas-salas", "l-salas-centros", "l-salas-sofa", "l-salas-sillones", "l-salas-libreros", "l-salas-mesas", "l-salas-bancas", "l-salas-puffs", "l-salas-bar", "f-muebles-salas-centros", "l-comedor-cocinas", "l-comedor-comedores", "l-comedor-muebles-de-cocina", "l-comedor-mesas", "l-comedor-sillas", "f-muebles-comedor-y-desayunador", "l-recamara-completa", "l-recamara-literas", "l-recamara-armario-closet", "l-recamara-comodas-cama", "l-recamara-buros", "l-recamara-cabeceras", "l-colchones-bases", "l-recamara-mesa-de-noche", "l-salas-bancas", "f-muebles-recamara", "l-ninos-cabeceras", "l-ninos-sillas", "l-cuarto-del-bebe-cunas", "l-cuarto-del-bebe-mecedoras", "l-cuarto-del-bebe-muebles", "f-muebles-ninos-y-juveniles", "l-oficina-escritorios", "l-oficina-sillas", "l-salas-libreros", "f-muebles-oficina-y-estudio-en-casa", "l-muebles-de-bano-muebles", "l-muebles-de-bano-accesorios", "l-muebles-de-bano-toallas", "l-muebles-de-bano-tapetes", "f-muebles-de-bano", "l-decoracion-tapetes", "l-decoracion-cojines-decorativos", "l-decoracion", "l-decoracion-portarretratos", "l-decoracion-cuadros", "l-decoracion-floreros", "l-decoracion-relojes", "f-muebles-decoracion", "l-persianas", "l-cortinas", "f-hogar-persianas-cortinas", "d-muebles", "lp-l-destacados-patio-jardin", "f-destacados-patio-y-jardin", "l-calentadores-chimeneas-calentadores", "l-calentadores-chimeneas-chimeneas", "f-patio-jardin-calentadores-chimeneas", "l-muebles-jardin", "l-muebles-jardin-salas", "l-muebles-jardin-hamacas-columpios-camastros", "l-muebles-jardin-mesas-sillas-plegables", "l-muebles-jardin-albercas-columpios-resbaladillas", "f-patio-jardin-muebles", "l-asadores-carbon", "l-asadores-gas", "l-asadores-accesorios", "f-patio-jardin-asadores", "l-decoracion-accesorios-jardin", "l-decoracion-carpas-toldos", "l-decoracion-sombrillas-bases", "f-patio-jardin-decoracion", "l-limpieza-estetica-automotriz-hidrolavadoras", "l-jardineria-riego", "l-jardineria-herramientas", "l-jardineria-desbrozadoras-podadoras", "l-jardineria-cobertizos", "f-patio-jardin-jardineria", "d-patio-jardin", "l-lp-destacados-tv-y-video", "f-destacados-tv-y-video", "l-pantallas-todas", "l-pantallas-smart", "l-pantallas-4K-ultrahd", "l-pantallas-27-menos-pulgadas", "l-pantallas-28-36-pulgadas", "l-pantallas-37-46-pulgadas", "l-pantallas-47-54-Pulgadas", "l-pantallas-55-64-Pulgadas", "l-pantallas-65-mas-pulgadas", "l-pantallas-tv-digital", "f-electronica-pantallas", "l-pantallas-tv-digital", "l-dvd-bluray-dvd", "l-dvd-bluray-bluray", "f-electronica-dvd-bluray", "l-accesorios-tv-soportes", "l-salas-centros", "f-electronica-muebles-y-soportes", "l-accesorios-tv-antenas", "l-accesorios-tv-cables", "l-accesorios-tv-soportes", "l-accesorios-tv-control-remoto", "f-electronica-accesorios-tv-video", "l-audio-casa-teatro", "l-audio-casa-barras", "f-audio-tv", "d-video", "l-lp-destacados-videojuegos", "f-destacados-videojuegos", "l-videojuegos-preventas", "l-videojuegos-lanzamientos", "f-videojuegos-lanzamientos-preventas", "l-nintendo-switch-consolas", "l-nintendo-switch-juegos", "l-nintendo-switch-accesorios", "f-videojuegos-nintendo-switch", "l-xbox-one-consolas", "l-xbox-one-juegos", "l-xbox-one-accesorios", "l-xbox-one-juegos-digitales", "f-videojuegos-xbox-one", "l-ps4-consolas", "l-ps4-juegos", "l-ps4-accesorios", "l-ps4-vr", "f-videojuegos-PlayStation-4", "l-nintendo-consolas", "l-nintendo-juegos", "l-nintendo-accesorios", "l-nintendo-juegos-wii-u", "f-videojuegos-nintendo", "l-xbox-360-juegos", "l-xbox-360-accesorios", "l-xbox-360-juegos-digitales", "f-videojuegos-xbox-360", "l-juegos-ps3", "l-juegos-ps-vita", "l-juegos-wii", "l-juegos-3ds", "l-juegos-wii-u", "l-coleccionables-consolas-retro", "f-videojuegos-juegos", "l-ps3-juegos", "l-ps3-accesorios", "f-videojuegos-playstation-3", "l-pc-gaming-juegos", "l-pc-gaming-accesorios", "l-pc-gaming-equipos", "f-videojuegos-pc-gaming", "d-videojuegos")

with open(FileCSV, 'w') as csvfile:
    fieldnames = ["Status", "Categoria", "descuento", "old_price", "new_price", "url_product", "product_name", "IsBundle", "upc"]
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
 
    writer.writeheader()

##Verify is Json is empty
def is_empty(any_structure):
    if any_structure:
        return False
    else:
        return True
    
##Get all the data from walmart.com.mx
def getData(category):
    
    for x in range (0,100):
        try:
        
            url = "https://www.walmart.com.mx/webcontrols/hlSearchFilter.ashx"
            dataJson = {"type":"l","id":category,"cuenta":0,"rows":25,"ini":x,"facets":[]}
            r = requests.post(url, json=dataJson)
            data = r.json()
            
            #Only do if Json isnt empty
            if is_empty(data) == False:
                domain = "https://www.walmart.com.mx/"

                for each in data[0]['data']:
                    
                    try:
                        product = each['Description']
                    except Exception:
                        product = "NULL"

                    try:   
                        new_price = float(each['PrecioNumerico'])
                        if new_price == 0:
                            new_price = float(each['Offers'][0]['Price'])
                    except Exception:
                        new_price = 0

                    try:
                        old_price = float(each['PreviousPrice'].replace('$','').replace(',',''))
                    except Exception:
                        old_price = 0
                    
                    try:
                        descuento = ((new_price / old_price) * 100.) -100
                    except Exception:
                        descuento = 0

                    try:
                        url_product = each['ProductUrl']
                        url_product = domain+url_product
                    except Exception:
                        url_product = "NONE"
                        
                    try:
                        upc = each['upc']
                    except Exception:
                        upc = ""
                        
                    IsBundle = each['IsBundle']
                    
##                    if new_price:
##                        print "######################################################"
##                        print "URL: " + str(url_product)
##                        print "product " + product
##                        print "new_price " + str(new_price)
##                        print "old_price " + str(old_price)
##                        print "DESCUENTO!!!!: " + str(descuento)
##                        if IsBundle == True:
##                            print "IsBundle: : " + str(IsBundle)
##                        print "UPC: : " + upc
##                        print "######################################################"

                        
                    #Categorias
                    laptops = (" I5 ", " I3 ", "AMD ", " A8 ", " A10 ", " A6 ")
                    i7 = (" I7 ", " GTX", "A12", "GTX1080", "GTX 1080")
                    intel =("INTEL ", " ite ")
                    tvs = ("CURVA ", " SMART ", " 42\"", " 40\"", " 49\"", " 45\"", " 65\"", " 60\"", " 4K")
                    consolas = ("CONSOLA", "XBOX ", "PS4 ", "PLAYSTATION 4", "WII", "SWITCH ")
                    hogar = ("COLCHON", "SPLIT", "LAVADORA", "CAMA ", "REFRIGERADOR", "ESTUFA")
                    hds = ("2TB", "3TB", "4TB", "8TB", "SSD")
                    celulares = ("XIAOMI ", " ANDROID ", "IPHONE ", "APPLE ", "SMARTPHONE ")
                    chucherias = ("PLANCHA", "MICROONDAS", "PIZZAR", "MOCHILA", "PANTALON", "ZAPATO",
                                  "VESTIR", "TRAJE", "RELOJ", "TENIS", "BACKPACK", "VINO ")
                    personal = ("PERFUME", "DESOD", "DESODORANTE", "ACNE", "ASEPXIA", "CEREAL", "PACK ", "PAQUETE", "AXE ", "BARBA ")
                    banned = ("FUNDA", "SOPORTE", "ADAPTADOR", "JUEGO", "CORREA", "WATCH", "MICA", "PROTECTOR", "ESTUCHE",
                              "XBOX 360", "NO BREAK", "CABLE", "CONTROL", "BRACERA", "REGULADOR", "PASS", "SUSCRIPCION",
                              "CODIGO", "2DS", "S4 -", "ACTIVISION", "DISNEY", "CHATPAD", "ONE -", "SINTONIZADORA", "CARGADOR",
                              "ARNES", "CHUPON", "POWERBANK", "PILA", "BATERIA", "LUZ", " STICKER ", "COOLING", "MOTHER", "MADRE",
                              "VGO", "CALCOMONIA", "CUBIERTA", "PALMREST", "VJGO", "CURVAS", "CREMA", "MICROFIBRA", "CURVATION",
                              "(XBO", "TABLET", " 32\"")

                    filtrar = None
                    Status = None
                    categoria = ""

                    if any(keyword in product.upper() for keyword in banned):
                        filtrar = False
                    else:
                        filtrar = True

                    if (filtrar == True) and (new_price is not 0):
                        #Buscamos
                        if any(keyword in product.upper() for keyword in laptops):
                            Status = 1
                            if new_price <= 7000:
                                Status = 0.1
                            categoria = "Laptops < 7000"
                        elif any(keyword in product.upper() for keyword in i7):
                            Status = 1.1
                            if new_price <= 10000:
                                Status = 0.11
                            categoria = "Gamer"
                        elif any(keyword in product.upper() for keyword in intel):
                            Status = 1.2
                            if new_price <= 4000:
                                Status = 0.12
                            categoria = "Laptops < 4000"
                        elif any(keyword in product.upper() for keyword in tvs):
                            Status = 2
                            if new_price <= 5000:
                                Status = 0.2
                            categoria = "TVs"
                        elif any(keyword in product.upper() for keyword in consolas):
                            Status = 3
                            if new_price <= 5000:
                                Status = 0.3
                            categoria = "Consolas"
                        elif any(keyword in product.upper() for keyword in hogar):
                            Status = 4
                            if new_price <= 1000:
                                Status = 0.4
                            categoria = "Hogar"
                        elif any(keyword in product.upper() for keyword in hds):
                            Status = 5
                            if new_price <= 1000:
                                Status = 0.5
                            categoria = "HDs"
                        elif any(keyword in product.upper() for keyword in celulares):
                            Status = 6
                            if new_price <= 1000:
                                Status = 0.6
                            categoria = "Celulares"
                        elif any(keyword in product.upper() for keyword in chucherias):
                            Status = 7
                            if new_price <= 100:
                                Status = 0.7
                            categoria = "Chucherias"
                        elif any(keyword in product.upper() for keyword in personal):
                            Status = 8
                            if new_price <= 25:
                                Status = 0.8
                            categoria = "Personal"

                    with open(FileCSV, 'a') as csvfile:
                        fieldnames = ["Status", "Categoria", "descuento", "old_price", "new_price", "url_product", "product_name", "IsBundle", "upc"]
                        writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
                        writer.writerow({"Status": Status, "Categoria": categoria , "descuento": descuento,
                         "old_price": old_price, "new_price": new_price, "url_product": url_product,
                         "product_name": str(product.encode('utf-8')), "IsBundle": IsBundle, "upc": upc})
                        
            else:
                break
            
        except Exception:
            print category + ": FAILED"
            break
    
    print ("Trying to Get all the data from: ...")
    print category
    print "######################################################"

i=0                              
for category in categories:
    print "|_________[" + str(i) +"]-[" + str(len(categories)) + "]_________|"
    getData(category)
    i+=1
    
print "*** - Spider has been closed - ***"
